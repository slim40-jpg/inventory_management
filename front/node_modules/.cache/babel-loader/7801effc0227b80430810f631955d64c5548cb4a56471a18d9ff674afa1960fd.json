{"ast":null,"code":"import React,{useState}from\"react\";import{useNavigate}from\"react-router-dom\";import axios from\"axios\";import\"./login.css\";import{jsx as _jsx,jsxs as _jsxs,Fragment as _Fragment}from\"react/jsx-runtime\";export default function Login(){const[showPassword,setShowPassword]=useState(false);const[email,setEmail]=useState(\"\");const[password,setPassword]=useState(\"\");const[error,setError]=useState(\"\");const[loading,setLoading]=useState(false);const navigate=useNavigate();const API_URL=\"http://localhost:5000\";// Your backend URL\nconst handleSubmit=async e=>{e.preventDefault();setError(\"\");// Basic validation\nif(!email||!password){setError(\"Tous les champs sont requis\");return;}// Email validation\nconst emailRegex=/^[^\\s@]+@[^\\s@]+\\.[^\\s@]+$/;if(!emailRegex.test(email)){setError(\"Format d'email invalide\");return;}setLoading(true);try{// Call backend API for login\nconst response=await axios.post(\"\".concat(API_URL,\"/api/AuthRoute/login\"),{email,password});if(response.data.success){const{token,user}=response.data;// Store authentication data\nlocalStorage.setItem(\"token\",token);localStorage.setItem(\"user\",JSON.stringify(user));localStorage.setItem(\"isLoggedIn\",\"true\");// Set default axios header for future requests\naxios.defaults.headers.common['Authorization']=\"Bearer \".concat(token);// Redirect based on user role\nif(user.role===\"admin\"){navigate(\"/admin-dashboard\");}else{navigate(\"/dashboard\");}}}catch(err){console.error(\"Login error:\",err);// Handle different error types\nif(err.response){// Server responded with error status\nswitch(err.response.status){case 400:setError(\"Donn√©es invalides\");break;case 401:setError(\"Email ou mot de passe incorrect\");break;case 404:setError(\"Utilisateur non trouv√©\");break;case 500:setError(\"Erreur serveur. Veuillez r√©essayer plus tard\");break;default:setError(\"Erreur de connexion\");}}else if(err.request){// Request was made but no response\nsetError(\"Impossible de se connecter au serveur\");}else{// Other errors\nsetError(\"Une erreur est survenue\");}}finally{setLoading(false);}};return/*#__PURE__*/_jsx(\"div\",{className:\"auth-container\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"auth-card\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"auth-icon\",children:/*#__PURE__*/_jsx(\"span\",{role:\"img\",\"aria-label\":\"box\",children:\"\\uD83D\\uDCE6\"})}),/*#__PURE__*/_jsx(\"h2\",{className:\"auth-title\",children:\"Connexion\"}),/*#__PURE__*/_jsx(\"p\",{className:\"auth-subtitle\",children:\"Acc\\xE9dez \\xE0 votre plateforme de gestion\"}),/*#__PURE__*/_jsxs(\"form\",{className:\"auth-form\",onSubmit:handleSubmit,children:[error&&/*#__PURE__*/_jsxs(\"div\",{className:\"error-message\",children:[/*#__PURE__*/_jsx(\"span\",{style:{marginRight:\"8px\"},children:\"\\u26A0\\uFE0F\"}),error]}),/*#__PURE__*/_jsx(\"label\",{htmlFor:\"email\",children:\"Email\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"auth-input\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"icon\",children:\"\\u2709\\uFE0F\"}),/*#__PURE__*/_jsx(\"input\",{id:\"email\",type:\"email\",placeholder:\"votre@email.com\",value:email,onChange:e=>setEmail(e.target.value),disabled:loading,required:true})]}),/*#__PURE__*/_jsx(\"label\",{htmlFor:\"password\",children:\"Mot de passe\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"auth-input\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"icon\",children:\"\\uD83D\\uDD12\"}),/*#__PURE__*/_jsx(\"input\",{id:\"password\",type:showPassword?\"text\":\"password\",placeholder:\"\\u2022\\u2022\\u2022\\u2022\\u2022\\u2022\\u2022\\u2022\",value:password,onChange:e=>setPassword(e.target.value),disabled:loading,required:true,minLength:\"6\"}),/*#__PURE__*/_jsx(\"span\",{className:\"toggle-password\",onClick:()=>!loading&&setShowPassword(!showPassword),style:{cursor:loading?\"not-allowed\":\"pointer\"},children:showPassword?\"üôà\":\"üëÅÔ∏è\"})]}),/*#__PURE__*/_jsx(\"button\",{type:\"submit\",className:\"auth-button\",disabled:loading,children:loading?/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(\"span\",{className:\"spinner\",style:{marginRight:\"8px\"},children:\"\\u23F3\"}),\"Connexion en cours...\"]}):\"Se connecter\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"auth-links\",children:[/*#__PURE__*/_jsx(\"a\",{href:\"/forgot-password\",className:\"forgot-password\",children:\"Mot de passe oubli\\xE9 ?\"}),/*#__PURE__*/_jsxs(\"p\",{className:\"auth-switch\",children:[\"Vous n'avez pas de compte ?\",\" \",/*#__PURE__*/_jsx(\"a\",{href:\"/register\",children:\"Cr\\xE9er un compte\"})]})]})]})]})});}","map":{"version":3,"names":["React","useState","useNavigate","axios","jsx","_jsx","jsxs","_jsxs","Fragment","_Fragment","Login","showPassword","setShowPassword","email","setEmail","password","setPassword","error","setError","loading","setLoading","navigate","API_URL","handleSubmit","e","preventDefault","emailRegex","test","response","post","concat","data","success","token","user","localStorage","setItem","JSON","stringify","defaults","headers","common","role","err","console","status","request","className","children","onSubmit","style","marginRight","htmlFor","id","type","placeholder","value","onChange","target","disabled","required","minLength","onClick","cursor","href"],"sources":["C:/Users/slims/OneDrive/Documents/front/src/login.js"],"sourcesContent":["import React, { useState } from \"react\";\nimport { useNavigate } from \"react-router-dom\";\nimport axios from \"axios\";\nimport \"./login.css\";\n\nexport default function Login() {\n  const [showPassword, setShowPassword] = useState(false);\n  const [email, setEmail] = useState(\"\");\n  const [password, setPassword] = useState(\"\");\n  const [error, setError] = useState(\"\");\n  const [loading, setLoading] = useState(false);\n  const navigate = useNavigate();\n\n  const API_URL = \"http://localhost:5000\"; // Your backend URL\n\n  const handleSubmit = async (e) => {\n    e.preventDefault();\n    setError(\"\");\n    \n    // Basic validation\n    if (!email || !password) {\n      setError(\"Tous les champs sont requis\");\n      return;\n    }\n\n    // Email validation\n    const emailRegex = /^[^\\s@]+@[^\\s@]+\\.[^\\s@]+$/;\n    if (!emailRegex.test(email)) {\n      setError(\"Format d'email invalide\");\n      return;\n    }\n\n    setLoading(true);\n\n    try {\n      // Call backend API for login\n      const response = await axios.post(`${API_URL}/api/AuthRoute/login`, {\n        email,\n        password\n      });\n\n      if (response.data.success) {\n        const { token, user } = response.data;\n        \n        // Store authentication data\n        localStorage.setItem(\"token\", token);\n        localStorage.setItem(\"user\", JSON.stringify(user));\n        localStorage.setItem(\"isLoggedIn\", \"true\");\n        \n        // Set default axios header for future requests\n        axios.defaults.headers.common['Authorization'] = `Bearer ${token}`;\n        \n        // Redirect based on user role\n        if (user.role === \"admin\") {\n          navigate(\"/admin-dashboard\");\n        } else {\n          navigate(\"/dashboard\");\n        }\n      }\n    } catch (err) {\n      console.error(\"Login error:\", err);\n      \n      // Handle different error types\n      if (err.response) {\n        // Server responded with error status\n        switch (err.response.status) {\n          case 400:\n            setError(\"Donn√©es invalides\");\n            break;\n          case 401:\n            setError(\"Email ou mot de passe incorrect\");\n            break;\n          case 404:\n            setError(\"Utilisateur non trouv√©\");\n            break;\n          case 500:\n            setError(\"Erreur serveur. Veuillez r√©essayer plus tard\");\n            break;\n          default:\n            setError(\"Erreur de connexion\");\n        }\n      } else if (err.request) {\n        // Request was made but no response\n        setError(\"Impossible de se connecter au serveur\");\n      } else {\n        // Other errors\n        setError(\"Une erreur est survenue\");\n      }\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  return (\n    <div className=\"auth-container\">\n      <div className=\"auth-card\">\n        <div className=\"auth-icon\">\n          <span role=\"img\" aria-label=\"box\">üì¶</span>\n        </div>\n\n        <h2 className=\"auth-title\">Connexion</h2>\n        <p className=\"auth-subtitle\">Acc√©dez √† votre plateforme de gestion</p>\n\n        <form className=\"auth-form\" onSubmit={handleSubmit}>\n          {error && (\n            <div className=\"error-message\">\n              <span style={{ marginRight: \"8px\" }}>‚ö†Ô∏è</span>\n              {error}\n            </div>\n          )}\n\n          {/* Email */}\n          <label htmlFor=\"email\">Email</label>\n          <div className=\"auth-input\">\n            <span className=\"icon\">‚úâÔ∏è</span>\n            <input \n              id=\"email\"\n              type=\"email\" \n              placeholder=\"votre@email.com\"\n              value={email}\n              onChange={(e) => setEmail(e.target.value)}\n              disabled={loading}\n              required\n            />\n          </div>\n\n          {/* Password */}\n          <label htmlFor=\"password\">Mot de passe</label>\n          <div className=\"auth-input\">\n            <span className=\"icon\">üîí</span>\n            <input\n              id=\"password\"\n              type={showPassword ? \"text\" : \"password\"}\n              placeholder=\"‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢\"\n              value={password}\n              onChange={(e) => setPassword(e.target.value)}\n              disabled={loading}\n              required\n              minLength=\"6\"\n            />\n            <span\n              className=\"toggle-password\"\n              onClick={() => !loading && setShowPassword(!showPassword)}\n              style={{ cursor: loading ? \"not-allowed\" : \"pointer\" }}\n            >\n              {showPassword ? \"üôà\" : \"üëÅÔ∏è\"}\n            </span>\n          </div>\n\n          <button \n            type=\"submit\" \n            className=\"auth-button\"\n            disabled={loading}\n          >\n            {loading ? (\n              <>\n                <span className=\"spinner\" style={{ marginRight: \"8px\" }}>‚è≥</span>\n                Connexion en cours...\n              </>\n            ) : (\n              \"Se connecter\"\n            )}\n          </button>\n\n          <div className=\"auth-links\">\n            <a href=\"/forgot-password\" className=\"forgot-password\">\n              Mot de passe oubli√© ?\n            </a>\n            <p className=\"auth-switch\">\n              Vous n'avez pas de compte ?{\" \"}\n              <a href=\"/register\">Cr√©er un compte</a>\n            </p>\n          </div>\n        </form>\n      </div>\n    </div>\n  );\n}"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}